<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <style type="text/css">
      <!--
        @import url(style.css);
      //-->
    </style>
    <title>KikainekoMocker Project Web Site</title>
  </head>
  <body>
    <div id="wrapper">
    
      <div id="header">
        <img class="kikaineko" src="img/kikaineko_top.png" alt="KikainekoMocker Project Web Site"/>
        <p class="language"><a href="en/index.html">English</a></p>
      </div>　<!-- end of header section -->
      
      <div id="main">
      <h1>KikainekoMocker</h1>
      <h1>Java</h1>
      <h1>Mock</h1>
      <h1>機械猫モッカー</h1>
      <h1>モック</h1>
            
        <div id="left">
        
        <h2>テスト・コードから<span class="orange">ク</span>ラスを自動生成</h2>
          
          <div class="desc">
            <p>
            機械猫モッカー (KikainekoMocker) は、テスト・ケースから擬似クラスを自動生成する手法を実現するツールです。(*1)
            </p>
            <p>
            擬似クラスとは、モックやスタブ、ドライバなどの名前で知られる実装は正しくないが、見かけ上は正しいクラスと同じ振る舞いを見せるクラス」のことで、主に開発・テストを容易にするために用いられます。
            </p>
            <p>
            機械猫モッカー (KikainekoMocker) は、SCT (Simulated-Class by Tests) というテスト・ケースから擬似クラスを自動生成する手法を実現するツールです。
            </p>
            <p>
            機械猫モッカーは、JUnit のテスト・ケースを読み、そのテストを通る擬似クラスを生成します。
            </p>
            <br/>
            <p>
            (*1)&nbsp;このような手法をSCTと呼んでいます。SCTについての詳細はこちらをご覧ください。<br/>
            <a href="sct.html">「擬似クラスとSCT」</a>
          </div>  <!-- end of desc section -->



        <h2>テス<span class="orange">ト</span>を通る擬似クラスを作成</h2>
          <div class="desc">
            <p>
            機械猫モッカーは、JUnit のテスト・ケースを読み、そのテストを通る擬似クラスを生成します。
            </p>
            <p>
            例えば、今HogeTestクラスというHogeクラスをテストするテスト・コードがあったとします。<br/>
            ここで、機械猫モッカーにHogeTestを渡すと、HogeTestを解析しHogeクラスを自動で実装します。
            この自動生成されたHogeクラスは確実にHogeTestをパスするように実装されます。
            ただし実装としては、正しい実装はなされませんので注意してください。
            </p>
            <p>
            <img src="img/intro01.jpg" alt="HogeTestを解析し Hogeクラスを生成">
            </p>
            <p>
            では、この擬似クラスはどのような場合に便利なんでしょうか？<br/>
            </p>
            <p>
            一つは後に紹介する「モック・パターン」というものがあります。<br/>
            このモック・パターンを使用して開発／テストを簡単に行えるようになります。
            他に設計の簡単な確認や、より良いインターフェースの探索などに使用することが可能です。
            </p>
          </div>  <!-- end of desc section -->



        <h2>どのような場合に使用<span class="orange">す</span>るのか？</h2>
          <div class="desc">
            <p>
            機械猫モッカーはテストさえ書けば、擬似とは言え実際に動くクラスを手にすることができるツールです。
            </p>
            <p>
            このことを上手く使えば様々な用途に使えます。<br/>
            代表的な使用方法としては「モック・パターン」というものがありますが、ここではどのような場合に擬似クラスを必要とするのかを紹介します。
            </p>
          </div>  <!-- end of desc section -->
          
        <h3>複数<span class="orange">人</span>でソフトウェアを開発する場合</h3>
          <div class="desc">
            <p>複数人で1つのソフトウエアを開発する場合、クラスの依存関係が問題になる場合があります。</p>
            <p>
            例えばあなたがAクラスを実装する予定であったとして、このときAクラスは、他のメンバーが開発中（あるいは開発予定）のBクラスに依存する場合、あなたはBクラスが完成するまでAクラスの実装／テストに入ることができなくなってしまいます。
            </p>
            <p>
            このようにクラス間の依存関係が問題になる場合があります。<br/>
            このため依存関係を注意しながらスケジュールを組む必要があったり、また最近ではこの依存関係を解消するための様々な技術（DIなど）が知られるようになりましたが擬似クラスはこの依存関係を解消する手法の一つです。つまり、Bクラスの擬似クラスを用意することで、Aクラスの実装／テストに入ることができます。
            </p>
            <p>
            <img src="img/intro02.jpg" alt="依存関係のあるクラスを擬似クラスで代用">
            </p>
            <p>ここまでは擬似クラスが持つ利点です。そしてこのような状況で、機械猫モッカーは威力を発揮します。</p>
            <p>
            つまりBクラスの擬似クラスを生成するのに機械猫モッカーを使用することができるのです。
            しかも、機械猫モッカーを使用するにはテストだけを書きさえすれば良いのです。
            </p>
            <p>
            この場合、Bクラスに対するテストを書きます。そのBクラスのテストを機械猫モッカーに読ませればBクラスの擬似クラスを生成します。
            </p>
            <p>
            また、テストを定義としているため以下のような利点を享受できます。
              <ul>
              <li>Bクラスの開発者にテストだけなら書いてもらいやすい</li>
              <li>テスト・コードは具体的なため、メンバー間での誤解が生まれにくい</li>
              <li>リアルなBクラスができた場合に、そのテストを再利用できる</li>
              </ul>
            </p>
            <p>
            Bクラスの実装は難しくても、そのテストはあまりコストが掛からない場合がよくあります。
            そのためBクラスの開発予定者にテストを書いてもらい、そこから生成することができます。
            </p>
            <p>また、テストコードはリアルなコードであるため互いの認識がずれにくいという利点もあります。</p>
            <p>そして、リアルなBクラスが完成した際に、定義として用いたテストコードを再利用してテストが可能になります。</p>
          </div>  <!-- end of desc section -->

        <h3>環境に依<span class="orange">存</span>する場合</h3>
          <div class="desc">
            <p>DBなどのような環境に依存したクラスの開発／テストはコストが高くついてしまいがちであることが知られています。</p>
            <p>つまり、環境を準備することが大変であったり、ちょっとテストするのにも時間やコストがかかったりしてしまうためです。</p>
            <p>
            ここでも擬似クラスを使用して環境への依存を解消することができます。
            つまり環境に依存した部分を切り出し、擬似クラスに置き換えてしまうのです。
            </p>
            <p>
            そして機械猫モッカーを使用すれば複雑なクエリーを書くことも、環境を意識する必要もなくテストさえ書けばよいのです。
            <p>
          </div>  <!-- end of desc section -->
          
        <h3>さらには<span class="orange">!?</span></h3>
          <div class="desc">
            <p>上記のように擬似クラスは依存関係を解消するのに威力を発揮します。</p>
            <p>
            ですが、機械猫モッカーはただ擬似クラスを生成するだけではなく、テスト・コードを使用することを上手く使うことが考えられます。</p>
            <p>
            例えば、ちょっと設計したものを実際に動かす・・・。皆さん新しい方法を模索してみてください。そして教えてください。笑
            </p>
          </div>  <!-- end of desc section -->
          
          
          
        <h2>どのようなテストを書<span class="orange">く</span>のか？</h2>
          <div class="desc">
            <p>
            詳しいテストケースの書き方や機械猫モッカーの使用方法については、<a href="userguide.html">「機械猫モッカーをどのように使うのか」</a>をご参照ください。
            </p>
            <p>ここでは概要を理解していただくことを目的に、どのような擬似クラスが欲しいときにどのようなテストを書けばよいかを解説します。</p>
          </div>  <!-- end of desc section -->
          
        <h3>単<span class="orange">純</span>な計算を行う擬似クラスを作る</h3>
          <div class="desc">
            <p>例えば、演算をsetして、計算させるような擬似クラスが欲しい場合、以下のようなテストを書けばよいでしょう。</p>
            <pre class="code">
package sample;
import junit.framework.TestCase;

public class CalcTest extends TestCase {
  Calc calc;

public void testAdd(){
  calc=new Calc();
  calc.set("+");
  assertEquals(5,calc.get(2,3));
}</pre>
            <p>これで「+」をセットした後でgetメソッドに2と3を入れると5を返してくれる擬似クラスを生成することができます。</p>
          </div>  <!-- end of desc section -->

        <h3>オブジェクト型を扱う擬<span class="orange">似</span>クラスを作る</h3>
          <div class="desc">
            <p>機械猫モッカーはオブジェクト型の扱いも問題ないため、オブジェクト型を扱う擬似クラスを生成することができます。</p>
            <p>例えば、さきほどの上のテストコードのint部分をInteger型に変えたテストにしてもモッカーは正しく生成します。</p>
            <pre class="code">
public void testAddInteger(){
  calc=new Calc();
  calc.set("+");
  Integer i2=new Integer(2);
  Integer i3=new Integer(3);
  assertEquals(new Integer(5),calc.get(i2,i3));
}</pre>
            <p>どうでしょうか、機械猫モッカーに読ませるテストだと言っても、普通のテストケースとなんら変わりませんね。</p>
          </div>  <!-- end of desc section -->
          
        <h3>色々な値を返すメソッドを持つ擬似クラスを<span class="orange">作</span>る</h3>
          <div class="desc">
            <p>さて、今までの例では一つのメソッドは一つの値を返していませんでした。</p>
            <p>では、次に色々な値を返すメソッドを持つ擬似クラスを作ってみましょう。</p>
            <pre class="code">
public void testIncrement(){
  calc=new Calc();
  calc.setIncrement(1,0);
  assertEquals(0,calc.next());
  assertEquals(1,calc.next());
  assertEquals(2,calc.next());
}</pre>
            <p>処理に特に意味はないのですが、一つ一つカウントアップするテストの例です。</p>
            <p>
            当然このようなテストも問題なく擬似クラスを生成します。<br/>
            これも、自然なテストケースですね。<br/>
            また、もちろんsetUpメソッドやtearDownメソッドをオーバーライドしていても何の問題もありません。
            </p>
            <p>このように機械猫モッカーでは普通のテストケースから擬似クラスを生成することが可能です。</p>
          </div>  <!-- end of desc section -->
      
      </div>  <!-- end of left section -->
      
      
      <div id="right">
        <h2>Conte<span class="orange">n</span>ts</h2>
        <div class="desc">
          <ul>
            <li><a href="index.html">ホーム</a></li>
            <li><span class="strong">何ができるのか</span></li>
            <li><a href="userguide.html">どのように使うのか</a></li>
            <li><a href="techoverview.html">どのように動いているのか</a></li>
            <li><a href="http://sourceforge.jp/projects/kikainekomocker/files/">ダウンロード</a></li>
          </ul>
        </div>
      </div>  <!-- end of right section -->
      
      </div> <!-- end of main section -->
 
      <div id="footer">
        &copy;Copyright 2006 The Seasar Foundation.&nbsp;&nbsp;All rights reserved.
      </div>
      
    </div> <!-- end of wrapper section -->
  </body>
</html>
